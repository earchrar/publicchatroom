import{c as O,o as q,q as L,a as Y,w as X,T as E,b as H,d as $}from"./style-DE76n6MI.js";import{t as h,n as C,g as v,a as F,e as N,m as _,b as p}from"./en-US-gc0wpjly.js";/* empty css            */function U(n,t){let e=n,o=t;const s=O($,"chats");let c=null;return{addChat:async l=>{const g=new Date,r={username:o,room:e,message:l,created_at:E.fromDate(g)};try{return await H(s,r)}catch(u){throw console.log("Err addChat = ",u),u}},getChats:l=>{c&&c(),c=q(L(s,X("room","==",e),Y("created_at")),g=>{g.docChanges().forEach(r=>{r.type==="added"&&l(r.doc.data())})})},updateChatroom:l=>{e=l},updateUsername:l=>{o=l,localStorage.setItem("username",o)}}}function y(n,t){const e=+h(n)-+h(t);return e<0?-1:e>0?1:e}function z(n,t,e){const[o,s]=C(e?.in,n,t),c=o.getFullYear()-s.getFullYear(),i=o.getMonth()-s.getMonth();return c*12+i}function A(n){return t=>{const e=Math.trunc,o=e(t);return o===0?0:o}}function R(n,t){return+h(n)-+h(t)}function j(n,t){const e=h(n,t?.in);return e.setHours(23,59,59,999),e}function k(n,t){const e=h(n,t?.in),o=e.getMonth();return e.setFullYear(e.getFullYear(),o+1,0),e.setHours(23,59,59,999),e}function G(n,t){const e=h(n,t?.in);return+j(e,t)==+k(e,t)}function B(n,t,e){const[o,s,c]=C(e?.in,n,n,t),i=y(s,c),a=Math.abs(z(s,c));if(a<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-i*a);let f=y(s,c)===-i;G(o)&&a===1&&y(o,c)===1&&(f=!1);const d=i*(a-+f);return d===0?0:d}function J(n,t,e){const o=R(n,t)/1e3;return A()(o)}function K(n,t,e){const s=F().locale??N,c=2520,i=y(n,t);if(isNaN(i))throw new RangeError("Invalid time value");const a=Object.assign({},e,{addSuffix:e?.addSuffix,comparison:i}),[f,d]=C(e?.in,...i>0?[t,n]:[n,t]),l=J(d,f),g=(v(d)-v(f))/1e3,r=Math.round((l-g)/60);let u;if(r<2)return r===0?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",r,a);if(r<45)return s.formatDistance("xMinutes",r,a);if(r<90)return s.formatDistance("aboutXHours",1,a);if(r<_){const m=Math.round(r/60);return s.formatDistance("aboutXHours",m,a)}else{if(r<c)return s.formatDistance("xDays",1,a);if(r<p){const m=Math.round(r/_);return s.formatDistance("xDays",m,a)}else if(r<p*2)return u=Math.round(r/p),s.formatDistance("aboutXMonths",u,a)}if(u=B(d,f),u<12){const m=Math.round(r/p);return s.formatDistance("xMonths",m,a)}else{const m=u%12,x=Math.trunc(u/12);return m<3?s.formatDistance("aboutXYears",x,a):m<9?s.formatDistance("overXYears",x,a):s.formatDistance("almostXYears",x+1,a)}}function P(n){return{newli:o=>{const s=K(o.created_at.toDate(),new Date),c=`
            <li class="shadow rounded-lg px-4 py-2">
                <div class="flex justify-between items-center">
                    <h5 class="text-gray-600 font-medium text-sm">${o.username}</h5>
                    <i class="text-gray-300 text-xs">${s}</i>
                </div>
                <p class="text-gray-600 text-sm">${o.message}</p>
            </li>
        `;n.innerHTML+=c},resetli:()=>{n.innerHTML=""}}}const Q=document.querySelector(".chatrooms"),V=document.querySelector(".chat-ul"),w=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),I=document.querySelector(".msg"),T=document.querySelector(".roomtitle"),b=localStorage.username?localStorage.username:"Guest";D.username.placeholder=b?`username is ${b}`:"";const M=U("general",b);T.textContent="General";const S=P(V);w.addEventListener("submit",n=>{n.preventDefault();const t=w.message.value.trim();M.addChat(t).then(()=>w.reset()).catch(e=>console.log(e))});D.addEventListener("submit",n=>{n.preventDefault();const t=D.username.value.trim();M.updateUsername(t),D.reset(),I.innerText=`New name updated to ${t}`,D.username.placeholder=`username is ${t}`,setTimeout(()=>I.innerText="",3e3)});Q.addEventListener("click",n=>{n.preventDefault();const t=n.target.closest("button");if(t){S.resetli();const e=t.getAttribute("id"),o=t.querySelector("h3").innerText;T.textContent=o,M.updateChatroom(e)}M.getChats(e=>{S.newli(e)})});M.getChats(n=>{S.newli(n)});
