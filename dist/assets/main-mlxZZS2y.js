import{c as q,g as L,d as E,a as Y,b as C,o as X,q as A,e as H,w as $,T as F,f as N}from"./style-D43JxHUt.js";import{t as h,n as S,g as I,a as z,e as R,m as _,b as M}from"./en-US-D8YhShSm.js";/* empty css            */function U(n,t){let e=n,o=t;const s=q(C,"chats");let c=null;const u=async f=>{const r=new Date,i={username:o,room:e,message:f,created_at:F.fromDate(r)};try{return await N(s,i)}catch(l){throw console.log("Err addChat = ",l),l}},a=f=>{c&&c(),c=X(A(s,$("room","==",e),H("created_at")),r=>{r.docChanges().forEach(i=>{i.type==="added"&&f(i.doc.data())})})},m=f=>{e=f},d=f=>{o=f,localStorage.setItem("username",o)};return(()=>{let f=setInterval(async()=>{try{const r=await L(s);if(r.empty){console.log("No message to delete"),clearInterval(f);return}r.forEach(async i=>{await E(Y(C,"chats",i.id))}),console.log("All messages deleted successfully")}catch(r){console.log("Error deleting message : ",r)}},1500)})(),{addChat:u,getChats:a,updateChatroom:m,updateUsername:d}}function y(n,t){const e=+h(n)-+h(t);return e<0?-1:e>0?1:e}function j(n,t,e){const[o,s]=S(e?.in,n,t),c=o.getFullYear()-s.getFullYear(),u=o.getMonth()-s.getMonth();return c*12+u}function k(n){return t=>{const e=Math.trunc,o=e(t);return o===0?0:o}}function G(n,t){return+h(n)-+h(t)}function B(n,t){const e=h(n,t?.in);return e.setHours(23,59,59,999),e}function J(n,t){const e=h(n,t?.in),o=e.getMonth();return e.setFullYear(e.getFullYear(),o+1,0),e.setHours(23,59,59,999),e}function K(n,t){const e=h(n,t?.in);return+B(e,t)==+J(e,t)}function P(n,t,e){const[o,s,c]=S(e?.in,n,n,t),u=y(s,c),a=Math.abs(j(s,c));if(a<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-u*a);let m=y(s,c)===-u;K(o)&&a===1&&y(o,c)===1&&(m=!1);const d=u*(a-+m);return d===0?0:d}function Q(n,t,e){const o=G(n,t)/1e3;return k()(o)}function V(n,t,e){const s=z().locale??R,c=2520,u=y(n,t);if(isNaN(u))throw new RangeError("Invalid time value");const a=Object.assign({},e,{addSuffix:e?.addSuffix,comparison:u}),[m,d]=S(e?.in,...u>0?[t,n]:[n,t]),v=Q(d,m),f=(I(d)-I(m))/1e3,r=Math.round((v-f)/60);let i;if(r<2)return r===0?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",r,a);if(r<45)return s.formatDistance("xMinutes",r,a);if(r<90)return s.formatDistance("aboutXHours",1,a);if(r<_){const l=Math.round(r/60);return s.formatDistance("aboutXHours",l,a)}else{if(r<c)return s.formatDistance("xDays",1,a);if(r<M){const l=Math.round(r/_);return s.formatDistance("xDays",l,a)}else if(r<M*2)return i=Math.round(r/M),s.formatDistance("aboutXMonths",i,a)}if(i=P(d,m),i<12){const l=Math.round(r/M);return s.formatDistance("xMonths",l,a)}else{const l=i%12,p=Math.trunc(i/12);return l<3?s.formatDistance("aboutXYears",p,a):l<9?s.formatDistance("overXYears",p,a):s.formatDistance("almostXYears",p+1,a)}}function W(n){return{newli:o=>{const s=V(o.created_at.toDate(),new Date),c=`
            <li class="shadow rounded-lg px-4 py-2">
                <div class="flex justify-between items-center">
                    <h5 class="text-gray-600 font-medium text-sm">${o.username}</h5>
                    <i class="text-gray-300 text-xs">${s}</i>
                </div>
                <p class="text-gray-600 text-sm">${o.message}</p>
            </li>
        `;n.innerHTML+=c},resetli:()=>{n.innerHTML=""}}}const Z=document.querySelector(".chatrooms"),ee=document.querySelector(".chat-ul"),w=document.querySelector(".chat-form"),g=document.querySelector(".user-form"),T=document.querySelector(".msg"),O=document.querySelector(".roomtitle"),x=localStorage.username?localStorage.username:"Guest";g.username.placeholder=x?`username is ${x}`:"";const D=U("general",x);O.textContent="General";const b=W(ee);w.addEventListener("submit",n=>{n.preventDefault();const t=w.message.value.trim();D.addChat(t).then(()=>w.reset()).catch(e=>console.log(e))});g.addEventListener("submit",n=>{n.preventDefault();const t=g.username.value.trim();D.updateUsername(t),g.reset(),T.innerText=`New name updated to ${t}`,g.username.placeholder=`username is ${t}`,setTimeout(()=>T.innerText="",3e3)});Z.addEventListener("click",n=>{n.preventDefault();const t=n.target.closest("button");if(t){b.resetli();const e=t.getAttribute("id"),o=t.querySelector("h3").innerText;O.textContent=o,D.updateChatroom(e)}D.getChats(e=>{b.newli(e)})});D.getChats(n=>{b.newli(n)});
